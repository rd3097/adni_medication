---
title: "adni_medication"
output: html_document
date: "2024-09-03"
---

```{r}
library(dplyr)
library(tidyr)
library(stringr)
library(tools)
```

```{r}
medication = read.csv('/Users/viv/Desktop/data science/meds.csv')
adnimerge = read.csv('/Users/viv/Desktop/data science/adni_merge.csv')
```

```{r}

#clean cmmed for letter a
cl_med_a <-medication%>%
  janitor::clean_names()%>%
  #drop empty 22411 rows
  mutate(cmmed = ifelse(cmmed == "", NA, cmmed))%>%
  drop_na(cmmed)%>%
  mutate(cmmed = str_to_title(cmmed))%>%
   # Remove double quotes from the strings
  mutate(cmmed = str_replace_all(cmmed, '"', "")) %>%
  # Remove single quotes from the strings
  mutate(cmmed = str_replace_all(cmmed, "'", "")) %>%

  mutate(cmmed = str_replace_all(cmmed, "\\[\\|194\\|\\]\\[\\|174\\|\\]", "")) %>%
  mutate(cmmed = case_when(
    str_detect(cmmed, "5% Saline Eye Drops") ~ "5% Saline Eye Drops",
    str_detect(cmmed, "Abs Sr. Plus") ~ "Abc Plus Senior",
    str_detect(cmmed, "Accopril") ~ "Accupril",
    str_detect(cmmed, "Acetaminophin|Acetamin") ~ "Acetaminophen",
    str_detect(cmmed, "Acetomenophen") ~ "Acetominophen",
    str_detect(cmmed, "Acetyl - L - Carnitine|Acetyl L Carnitine|Acetyl L- Canitine|Acetyl- L-Carnitine|Acetyl-L Carnitine") ~ "Acetyl L-Carnitine",
    str_detect(cmmed, "Acidolpheus|Acidophilus Pills|Acidophis") ~ "Acidophilus",
    str_detect(cmmed, "Acotonel|Actenol") ~ "Actonel",
    str_detect(cmmed, "Actose") ~ "Actos",
    #Acrobid might macrobid
    str_detect(cmmed,"Adalat Cc|Adalat Ex") ~"Adalat",
    str_detect(cmmed,"Advair Discus|Advair Disk") ~"Advair Diskus",
    #Advart might avodart
    str_detect(cmmed,"Aerobid Inhaler") ~"Aerobid",
    str_detect(cmmed,"Advil Es")~ "Advil",
    str_detect(cmmed,"Aggrenox Capsules Sa") ~ "Aggrenox",
    str_detect(cmmed,"Albuterol \\(Nebulizer\\)|Albuterol Nebulizer") ~ "Albuterol Inhaler",
    str_detect(cmmed,"Albuterol Sol" )~ "Albuterol Sulfate",
    str_detect(cmmed,"Aldara 5%")~ "Aldara",
    str_detect(cmmed,"Alenbronate|Alentdronate")~ "Alendronate",
    str_detect(cmmed,"Aledronate Sodium|Alendronate Sodium Usp")~ "Alendronate Sodium",
    str_detect(cmmed, "Align Cap") ~ "Align",
    str_detect(cmmed, "Alka Seltzer Plus|Alka Selzer Plus|Alka-Seltzer Plus Cold") ~ "Alka-Seltzer Plus",
    str_detect(cmmed,"Allegra \\(Fexofenadine\\)")~"Allegra",
    str_detect(cmmed, "Allergen Injections|Allergy Injection") ~ "Allergy Shots",
    str_detect(cmmed,"Allevert")~"Alleve",
    str_detect(cmmed,"Allopurinal")~"Allopurinol",
    str_detect(cmmed,"Alpha-Lipoic Acid")~"Alpha Lipoic Acid",
    str_detect(cmmed,"Alphagan P \\(Brimonidine Tartrate Ophthalmic Solution\\)|Alphagan P.o 15%") ~"Alphagan P",
    str_detect(cmmed, "Alphagan 0.15%") ~ "Alphagan",
    str_detect(cmmed,"Alprazalam|Alprazolm") ~"Alprazolam",
    str_detect(cmmed,"Amiordarone")~"Amiodarone",
    str_detect(cmmed,"Amitryptiline|Amittriptyline")~"Amitriptyline",
    str_detect(cmmed,"Amlod/Benaze") ~"Amlodipine/Benzapine",
    str_detect(cmmed,"Amoxicilin|Amoxicillan|Amoxicliin|Amoxil")~"Amoxicillin",
    str_detect(cmmed,"Androgel 1 %")~"Androgel 1%",
    str_detect(cmmed, "Antacid Tablet")~"Antacid Tablets",
    str_detect(cmmed,"Antibiotic \\(Name Unknown\\)")~"Antibiotic",
    str_detect(cmmed,"Antihistamine")~"Antihistamines",
    str_detect(cmmed,"Arenesp")~"Aranesp",
    str_detect(cmmed,"Aricept For Memory Impairment|Aricpet")~"Aricept",
    str_detect(cmmed,"Arimedex")~"Arimidex",
    str_detect(cmmed,"Armour|Armours Thyroid")~"Armour Thyroid",
    str_detect(cmmed,"Asa \\(Baby Asprin\\)|Asa \\(Baby\\)|Asa-Baby Asprin")~"Asa",
    str_detect(cmmed,"Aspirine|Aspril|Asprin|Aspririn")~"Aspirin",
    str_detect(cmmed,"Astelin Nasal Spray|Astelin Nose Spray")~"Astelin",
    str_detect(cmmed,"Atacand/Hctz")~"Atacand Hct",
    str_detect(cmmed,"Atenolol La|Atenol")~"Atenolol",
    str_detect(cmmed,"Atenolol/ Chlorthal|Atenolol+Chlorthalidine")~"Atenolol/Chlorthalidine",
    str_detect(cmmed,"Atrovastatin") ~"Atorvastatin",
    str_detect(cmmed,"Atrovant .06") ~"Atrovent 0.06%",
    str_detect(cmmed, "Azithronycin|Azitromycin") ~ "Azithromycin",

    
    str_detect(cmmed, "vit c") ~ "Vitamin C",
   
    TRUE ~ cmmed
  ))

```

```{r}
# Corrected code with str_detect used properly
cl_med_b <- cl_med_a %>%
  mutate(cmmed = case_when(
    str_detect(cmmed, "B 100") ~ "B-100",
    str_detect(cmmed, "B 12") ~ "B-12",
    str_detect(cmmed, "B Complex|B- Complex|Complex B") ~ "B-Complex",
    str_detect(cmmed, "B Complex Vitamin|B Complex/Vitamin|B Complex Vitamins") ~ "B-Complex Vitamin",
    str_detect(cmmed, "B-Complex 50") ~ "B-50 Complex",
    str_detect(cmmed, "Benicar Hctz") ~ "Benicar Hct",
    str_detect(cmmed, "Beta Carotine|Beta-Carotene") ~ "Beta Carotene",
    str_detect(cmmed, "Bethamethasone") ~ "Betamethasone",
    str_detect(cmmed, "Bethamethasone Valerate") ~ "Betamethasone Valerate",
    str_detect(cmmed, "Bisopril \\(Hctz\\)|Bisopropolol/Hctz") ~ "Bisoprolol Hctz",
    str_detect(cmmed, "Black Cohash") ~ "Black Cohosh",
    str_detect(cmmed, "Bone Up") ~ "BoneUp",
    str_detect(cmmed, "Brimonidine Tartate") ~ "Brimonidine Tartrate",
    str_detect(cmmed, "Buproprion") ~ "Bupropion",
    str_detect(cmmed, "Buproprion Er") ~ "Bupropion Er",
    str_detect(cmmed, "Buproprion Hcl") ~ "Bupropion Hcl",
    str_detect(cmmed, "Buproprion SR") ~ "Bupropion SR",
    TRUE ~ cmmed
  ))

```

```{r}
cl_med_c <- cl_med_b %>%
  mutate(cmmed = case_when(
    str_detect(cmmed, regex(
      "Ca W/ Vitamin D|Calcium & D|Calcium & Vitamin D|Calcium \\+ D|Calcium \\+ Vit D|Calcium \\+ Vit\\. D|Calcium \\+D|Calcium \\+Vit D|Calcium / Vitamin D|Calcium /Vitamin D|Calcium And Vitamin D|Calcium Vit D|Calcium/Vit D|Calcium/Vitamin D|Calcuim \\+ Vitamin D|Calcuim And Vitamin D|Calcuim Plus Vitamin D|Calcuim With Vitamin D", 
      ignore_case = TRUE)) ~ "Calcium + Vitamin D",
    str_detect(cmmed, regex("B 100", ignore_case = TRUE)) ~ "B-100",
    str_detect(cmmed, regex("Calcium 600 - D|Calcium 600 D|Calcium 600 \\+ D|Calcium 600\\+D", ignore_case = TRUE)) ~ "Calcium 600 Plus Vitamin D",
    str_detect(cmmed, regex("Combigan 0\\.2/0\\.5%", ignore_case = TRUE)) ~ "Combigan 0.2% / 0.5% Oph",
    str_detect(cmmed, regex("Congugated Estrogen", ignore_case = TRUE)) ~ "Conjugated Estrogen",
    str_detect(cmmed, regex("Coq-10|Coq 10|Coq\\=10|Coq10 Enzyme|Coq10|Coenzyme Q10 \\(Coq10\\)|Coenzime Q10|Coenzyme Q|Coenzyme Q 10|Coenzyme Q-10|Co-Enzyme Q|Co-Enzyme Q-10|Co-Enzyme Q10|Co-Q|Co-Q-10|Co-Q10", ignore_case = TRUE)) ~ "Coenzyme Q10",
    str_detect(cmmed, regex("Cozar", ignore_case = TRUE)) ~ "Cozaar",
    str_detect(cmmed, regex("Cran Actin", ignore_case = TRUE)) ~ "CranActin",
    str_detect(cmmed, regex("Cranberry \\+C", ignore_case = TRUE)) ~ "Cranberry + C",
    TRUE ~ cmmed
  ))

```

```{r}
#Exploratory Data
cl_med_c%>% 
  group_by(cmmed)%>%
  count()
medication%>% 
  group_by(CMREASON)%>%
  count()

```